# 🚀 LDesign CLI 启动说明

## ✅ 已修复: 支持IP访问

为了解决全局代理导致的localhost访问问题,CLI现在:

1. **默认监听 `0.0.0.0`** - 支持通过IP访问
2. **自动显示本机IP** - 启动时会显示网络IP地址
3. **优先使用IP打开浏览器** - 绕过代理问题

## 🎯 启动方法

### 方式1: 在新窗口查看完整日志(推荐)

```powershell
# 打开新的PowerShell窗口
cd D:\WorkBench\ldesign\tools\cli
node bin/cli.js ui --debug
```

启动后会显示:
```
╭────────────────────────────────────╮
│                                    │
│   🎨 LDesign UI 已启动!            │
│                                    │
╰────────────────────────────────────╯

✅ LDesign UI 管理界面已启动

本地访问: http://localhost:3000
网络访问: http://192.168.x.x:3000

💡 提示: 如果使用了全局代理,请使用网络IP访问
```

### 方式2: 使用开发模式

```bash
npm run dev
```

### 方式3: 指定主机

```bash
# 只监听localhost
node bin/cli.js ui --host localhost

# 监听所有接口(默认)
node bin/cli.js ui --host 0.0.0.0

# 监听特定IP
node bin/cli.js ui --host 192.168.1.100
```

## 🌐 访问地址

启动后请查看PowerShell窗口显示的地址:

- **本地访问**: `http://localhost:3000`
- **网络访问**: `http://[你的IP]:3000` (会自动显示)

**如果有全局代理,使用网络IP访问!**

## 🔍 检查服务器是否启动

```powershell
# 检查端口监听
netstat -ano | findstr :3000

# 检查进程
Get-Process -Name node

# 测试API
Invoke-WebRequest -Uri "http://localhost:3000/health" -UseBasicParsing
```

## 🐛 如果还是无法访问

### 1. 查看新打开的PowerShell窗口

窗口中会显示:
- 启动日志
- IP地址
- 任何错误信息

### 2. 测试数据库初始化

```powershell
# 测试数据库是否正常
node -e "import('./dist/core/database/index.js').then(async m => { const db = m.getDatabaseManager(); await db.initialize(); console.log('✅ 数据库OK'); db.close() }).catch(e => console.error('❌ 数据库错误:', e))"
```

### 3. 使用测试服务器

```bash
# 使用简化的测试服务器
node test-direct.js

# 这个会在3001端口启动
# 访问 http://localhost:3001 或 http://[IP]:3001
```

## 💡 代理配置

如果使用全局代理,建议配置代理绕过本地地址:

### 代理软件设置

在代理规则中添加:
```
localhost
127.0.0.1
192.168.*
```

或直接使用IP地址访问,绕过localhost。

## 📊 预期的启动输出

```
[时间] [INFO] [UI] 正在启动 LDesign UI 管理界面...
[时间] [INFO] [UI] 正在初始化服务器...
[时间] [INFO] [Server] 正在创建服务器...
[时间] [INFO] 数据库初始化成功
[时间] [INFO] [ToolManager] 初始化工具管理器...
[时间] [INFO] [ToolManager] 工具管理器初始化完成
[时间] [INFO] [Server] 未找到前端资源，将使用占位页面
[时间] [INFO] [Server] 服务器创建成功
[时间] [INFO] [WebSocket] 初始化 WebSocket 服务器
[时间] [INFO] [WebSocket] WebSocket 服务器已启动

  ╭────────────────────────────────────╮
  │                                    │
  │   🎨 LDesign UI 已启动!            │
  │                                    │
  ╰────────────────────────────────────╯

✅ LDesign UI 管理界面已启动

本地访问: http://localhost:3000
网络访问: http://192.168.3.227:3000   ← 使用这个!

💡 提示: 如果使用了全局代理,请使用网络IP访问

按 Ctrl+C 退出
```

## 🎯 下一步

1. **在新打开的PowerShell窗口查看IP地址**
2. **使用显示的网络IP访问** (如 `http://192.168.x.x:3000`)
3. **如果成功,你会看到占位页面或前端UI**
4. **API也可以通过IP访问** (如 `http://192.168.x.x:3000/api/projects`)

---

**提示**: 新窗口现在应该已经打开了,请查看其中显示的IP地址!

