# CLI å·¥å…·é›†æˆè¿›åº¦æŠ¥å‘Š

## ğŸ“Š é¡¹ç›®æ¦‚è¿°

å°† 11 ä¸ªå·¥å…·åŒ…ï¼ˆanalyzer, builder, deployer, deps, docs-generator, git, generator, launcher, monitor, security, testerï¼‰é›†æˆåˆ° CLI çš„å¯è§†åŒ–ç•Œé¢ä¸­ï¼Œå®ç°é¡¹ç›®å…¨ç”Ÿå‘½å‘¨æœŸç®¡ç†çš„ç»Ÿä¸€å¹³å°ã€‚

## âœ… å·²å®Œæˆå·¥ä½œ

### 1. åŸºç¡€è®¾æ–½å±‚ï¼ˆ100%ï¼‰

#### 1.1 æ•°æ®åº“æ‰©å±• âœ…
å·²åœ¨ `DatabaseManager.ts` ä¸­æ–°å¢ 9 ä¸ªæ•°æ®è¡¨ï¼š

- `tool_services` - å·¥å…·æœåŠ¡é…ç½®è¡¨
- `build_records` - æ„å»ºè®°å½•è¡¨
- `analysis_reports` - åˆ†ææŠ¥å‘Šè¡¨
- `deployment_records` - éƒ¨ç½²è®°å½•è¡¨
- `documentation_records` - æ–‡æ¡£è®°å½•è¡¨
- `test_records` - æµ‹è¯•è®°å½•è¡¨
- `monitor_data` - ç›‘æ§æ•°æ®è¡¨
- `security_scans` - å®‰å…¨æ‰«æè¡¨
- `workflow_records` - å·¥ä½œæµè®°å½•è¡¨

**ä½ç½®**: `tools/cli/src/server/database/DatabaseManager.ts`

#### 1.2 ç±»å‹ç³»ç»Ÿ âœ…
åˆ›å»ºå®Œæ•´çš„ç±»å‹å®šä¹‰ç³»ç»Ÿï¼ŒåŒ…å«ï¼š

- å·¥å…·æœåŠ¡ç±»å‹ (`ToolServiceName`, `ServiceStatus`)
- ä»»åŠ¡çŠ¶æ€ç±»å‹ (`TaskStatus`)
- æ„å»ºã€åˆ†æã€éƒ¨ç½²ã€æµ‹è¯•ç­‰å„ç±»è®°å½•ç±»å‹
- æœåŠ¡æ¥å£å®šä¹‰ (`IToolService`)
- äº‹ä»¶ç±»å‹å®šä¹‰

**ä½ç½®**: `tools/cli/src/server/services/types.ts`

#### 1.3 æœåŠ¡ç®¡ç†å™¨ âœ…
å®ç°å·¥å…·æœåŠ¡ç®¡ç†å™¨ï¼Œæä¾›ï¼š

- æœåŠ¡æ³¨å†Œä¸å‘ç°æœºåˆ¶
- æœåŠ¡ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼ˆå¯åŠ¨/åœæ­¢/é‡å¯ï¼‰
- å¥åº·æ£€æŸ¥æœºåˆ¶ï¼ˆ60ç§’é—´éš”ï¼‰
- æœåŠ¡çŠ¶æ€ç®¡ç†å’ŒæŒä¹…åŒ–
- äº‹ä»¶å‘å¸ƒç³»ç»Ÿ

**ä½ç½®**: `tools/cli/src/server/services/tool-service-manager.ts`

### 2. Builder å·¥å…·é›†æˆï¼ˆ100%ï¼‰

#### 2.1 Builder æœåŠ¡é€‚é…å™¨ âœ…
- é›†æˆ `@ldesign/builder` åŒ…
- å®ç°æ„å»ºä»»åŠ¡æ‰§è¡Œ
- æ„å»ºè®°å½•ä¿å­˜åˆ°æ•°æ®åº“
- è¿›åº¦äº‹ä»¶å®æ—¶æ¨é€
- æ¨¡æ‹Ÿæ¨¡å¼æ”¯æŒï¼ˆå¼€å‘/æµ‹è¯•ç”¨ï¼‰

**ä½ç½®**: `tools/cli/src/server/services/builder-service.ts`

**æ ¸å¿ƒåŠŸèƒ½**:
- `build()` - æ‰§è¡Œæ„å»ºä»»åŠ¡
- `getBuildRecord()` - è·å–æ„å»ºè®°å½•
- `getBuildHistory()` - è·å–æ„å»ºå†å²
- `deleteBuildRecord()` - åˆ é™¤æ„å»ºè®°å½•

#### 2.2 Builder API è·¯ç”± âœ…
æä¾› RESTful API æ¥å£ï¼š

- `POST /api/builder/build` - æ„å»ºé¡¹ç›®
- `GET /api/builder/builds/:projectId` - è·å–é¡¹ç›®æ„å»ºå†å²
- `GET /api/builder/build/:buildId` - è·å–æ„å»ºè¯¦æƒ…
- `DELETE /api/builder/build/:buildId` - åˆ é™¤æ„å»ºè®°å½•

**ä½ç½®**: `tools/cli/src/server/routes/builder.ts`

#### 2.3 Builder UI ç•Œé¢ âœ…
å®Œæ•´çš„æ„å»ºç®¡ç†ç•Œé¢ï¼ŒåŒ…å«ï¼š

- æ„å»ºå†å²åˆ—è¡¨ï¼ˆç½‘æ ¼å¸ƒå±€ï¼‰
- é¡¹ç›®ç­›é€‰åŠŸèƒ½
- æ–°å»ºæ„å»ºå¯¹è¯æ¡†
- æ„å»ºé…ç½®è¡¨å•ï¼ˆæ ¼å¼ã€æ¨¡å¼ã€é€‰é¡¹ç­‰ï¼‰
- æ„å»ºçŠ¶æ€å¯è§†åŒ–
- äº§ç‰©å±•ç¤º

**ä½ç½®**: `tools/cli/src/web/src/views/BuildManager.vue`

**è®¿é—®è·¯å¾„**: `/builds`

### 3. ä¾èµ–é…ç½® âœ…

å·²åœ¨ `package.json` ä¸­æ·»åŠ æ‰€æœ‰å·¥å…·åŒ…ä¾èµ–ï¼š

```json
{
  "dependencies": {
    "@ldesign/analyzer": "workspace:*",
    "@ldesign/builder": "workspace:*",
    "@ldesign/deployer": "workspace:*",
    "@ldesign/deps": "workspace:*",
    "@ldesign/docs-generator": "workspace:*",
    "@ldesign/git": "workspace:*",
    "@ldesign/generator": "workspace:*",
    "@ldesign/launcher": "workspace:*",
    "@ldesign/monitor": "workspace:*",
    "@ldesign/security": "workspace:*",
    "@ldesign/tester": "workspace:*"
  }
}
```

**ä½ç½®**: `tools/cli/package.json`

### 4. æœåŠ¡å™¨é›†æˆ âœ…

åœ¨ Express æœåŠ¡å™¨ä¸­å®Œæˆï¼š

- å¯¼å…¥æœåŠ¡ç®¡ç†å™¨å’Œ Builder æœåŠ¡
- åˆå§‹åŒ–æœåŠ¡ç®¡ç†å™¨
- æ³¨å†Œ Builder æœåŠ¡
- æ·»åŠ  Builder API è·¯ç”±

**ä½ç½®**: `tools/cli/src/server/app.ts`

### 5. è·¯ç”±é…ç½® âœ…

åœ¨ Vue Router ä¸­æ·»åŠ  `/builds` è·¯ç”±

**ä½ç½®**: `tools/cli/src/web/src/router/routes.ts`

## ğŸš€ å¦‚ä½•ä½¿ç”¨

### å¯åŠ¨æœåŠ¡

```bash
cd tools/cli

# å®‰è£…ä¾èµ–
pnpm install

# å¼€å‘æ¨¡å¼ï¼ˆå‰åç«¯åŒæ—¶è¿è¡Œï¼‰
pnpm dev

# æˆ–åˆ†åˆ«å¯åŠ¨
pnpm dev:server  # å¯åŠ¨åç«¯æœåŠ¡å™¨
pnpm dev:web     # å¯åŠ¨å‰ç«¯å¼€å‘æœåŠ¡å™¨
```

### è®¿é—®ç•Œé¢

1. æ‰“å¼€æµè§ˆå™¨è®¿é—®: `http://localhost:3000`
2. å¯¼èˆªåˆ°"æ„å»ºç®¡ç†": `http://localhost:3000/builds`

### ä½¿ç”¨æ„å»ºåŠŸèƒ½

1. **æŸ¥çœ‹æ„å»ºå†å²**
   - è‡ªåŠ¨åŠ è½½æ‰€æœ‰é¡¹ç›®çš„æ„å»ºè®°å½•
   - å¯æŒ‰é¡¹ç›®ç­›é€‰

2. **åˆ›å»ºæ–°æ„å»º**
   - ç‚¹å‡»"æ–°å»ºæ„å»º"æŒ‰é’®
   - é€‰æ‹©é¡¹ç›®
   - é…ç½®æ„å»ºé€‰é¡¹ï¼š
     - è¾“å‡ºç›®å½•
     - æ„å»ºæ¨¡å¼ï¼ˆå¼€å‘/ç”Ÿäº§ï¼‰
     - è¾“å‡ºæ ¼å¼ï¼ˆESM/CJS/UMDï¼‰
     - Sourcemapã€å‹ç¼©ã€ç±»å‹å£°æ˜ç­‰é€‰é¡¹
   - ç‚¹å‡»"å¼€å§‹æ„å»º"

3. **æŸ¥çœ‹æ„å»ºè¯¦æƒ…**
   - ç‚¹å‡»æ„å»ºå¡ç‰‡æŸ¥çœ‹è¯¦æƒ…
   - æŸ¥çœ‹æ„å»ºæ—¥å¿—ã€äº§ç‰©ã€è€—æ—¶ç­‰ä¿¡æ¯

### API ä½¿ç”¨ç¤ºä¾‹

```javascript
// å¯åŠ¨æ„å»º
const response = await fetch('http://localhost:3000/api/builder/build', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    projectId: 'project-1',
    config: {
      projectPath: '/path/to/project',
      outDir: 'dist',
      mode: 'production',
      formats: ['esm', 'cjs'],
      sourcemap: true,
      minify: true,
      dts: true
    }
  })
})

const result = await response.json()
console.log('æ„å»ºID:', result.data.id)

// è·å–æ„å»ºå†å²
const historyResponse = await fetch('http://localhost:3000/api/builder/builds/project-1')
const history = await historyResponse.json()
console.log('æ„å»ºå†å²:', history.data)
```

## ğŸ“‹ å¾…å®Œæˆå·¥ä½œï¼ˆå‰©ä½™ 16 é¡¹ï¼‰

### é«˜ä¼˜å…ˆçº§ï¼ˆæ ¸å¿ƒåŠŸèƒ½ï¼‰

1. **Analyzer æœåŠ¡é›†æˆ**
   - æœåŠ¡é€‚é…å™¨
   - API è·¯ç”±
   - UI ç•Œé¢ï¼ˆåˆ†ææŠ¥å‘Šé¡µï¼‰

2. **Deployer æœåŠ¡é›†æˆ**
   - æœåŠ¡é€‚é…å™¨
   - API è·¯ç”±
   - UI ç•Œé¢ï¼ˆéƒ¨ç½²ç®¡ç†é¡µï¼‰

3. **å·¥ä½œæµå¼•æ“**
   - å·¥ä½œæµå®šä¹‰å’Œæ‰§è¡Œ
   - API è·¯ç”±
   - UI ç•Œé¢ï¼ˆå·¥ä½œæµç¼–æ’é¡µï¼‰

4. **WebSocket äº‹ä»¶æ‰©å±•**
   - æ„å»ºã€åˆ†æã€éƒ¨ç½²å®æ—¶äº‹ä»¶
   - å‰ç«¯äº‹ä»¶ç›‘å¬

5. **å·¥å…·æ€»è§ˆé¡µ**
   - æ‰€æœ‰æœåŠ¡çŠ¶æ€å±•ç¤º
   - å¿«æ·æ“ä½œå…¥å£

### ä¸­ä¼˜å…ˆçº§ï¼ˆå¢å¼ºåŠŸèƒ½ï¼‰

6. **é¡¹ç›®ç”Ÿå‘½å‘¨æœŸé¡µ**
   - å®Œæ•´çš„ç”Ÿå‘½å‘¨æœŸè§†å›¾
   - å…³é”®æŒ‡æ ‡çœ‹æ¿

7. **å…¶ä»–å·¥å…·æœåŠ¡é›†æˆ**
   - Tester
   - Docs-generator
   - Generator
   - Deps
   - Launcher

### ä½ä¼˜å…ˆçº§ï¼ˆä¼˜åŒ–ï¼‰

8. **åˆ†æå›¾è¡¨ç»„ä»¶**
   - Bundle Tree-map
   - ä¾èµ–å…³ç³»å›¾
   - æ€§èƒ½è¶‹åŠ¿å›¾
   - ä»£ç è´¨é‡é›·è¾¾å›¾

9. **æµ‹è¯•ä¸ä¼˜åŒ–**
   - æ€§èƒ½ä¼˜åŒ–
   - é”™è¯¯å¤„ç†å®Œå–„
   - ç”¨æˆ·ä½“éªŒä¼˜åŒ–
   - æ–‡æ¡£ç¼–å†™

## ğŸ—ï¸ æ¶æ„ç‰¹ç‚¹

### 1. æœåŠ¡åŒ–æ¶æ„
- æ¯ä¸ªå·¥å…·ä½œä¸ºç‹¬ç«‹æœåŠ¡
- ç»Ÿä¸€çš„æœåŠ¡ç®¡ç†å™¨
- å¥åº·æ£€æŸ¥æœºåˆ¶
- é”™è¯¯éš”ç¦»

### 2. é›†ä¸­å¼æ•°æ®å­˜å‚¨
- æ‰€æœ‰æ•°æ®å­˜å‚¨åœ¨ SQLite æ•°æ®åº“
- ç»Ÿä¸€çš„æ•°æ®æ¨¡å‹
- ç´¢å¼•ä¼˜åŒ–

### 3. å®æ—¶é€šä¿¡
- WebSocket æ”¯æŒ
- è¿›åº¦äº‹ä»¶æ¨é€
- çŠ¶æ€åŒæ­¥

### 4. æ¨¡å—åŒ–è®¾è®¡
- æœåŠ¡é€‚é…å™¨æ¨¡å¼
- ç»Ÿä¸€çš„æ¥å£è§„èŒƒ
- æ˜“äºæ‰©å±•

## ğŸ“ å…³é”®æ–‡ä»¶æ¸…å•

### åç«¯æ ¸å¿ƒ
- `src/server/database/DatabaseManager.ts` - æ•°æ®åº“ç®¡ç†å™¨ï¼ˆæ‰©å±•ï¼‰
- `src/server/services/types.ts` - ç±»å‹å®šä¹‰
- `src/server/services/tool-service-manager.ts` - æœåŠ¡ç®¡ç†å™¨
- `src/server/services/builder-service.ts` - Builder æœåŠ¡
- `src/server/routes/builder.ts` - Builder API
- `src/server/app.ts` - æœåŠ¡å™¨ä¸»æ–‡ä»¶ï¼ˆé›†æˆï¼‰

### å‰ç«¯æ ¸å¿ƒ
- `src/web/src/views/BuildManager.vue` - æ„å»ºç®¡ç†é¡µ
- `src/web/src/router/routes.ts` - è·¯ç”±é…ç½®ï¼ˆæ‰©å±•ï¼‰

### é…ç½®
- `package.json` - ä¾èµ–é…ç½®ï¼ˆæ‰©å±•ï¼‰

## ğŸ¯ ä¸‹ä¸€æ­¥å»ºè®®

### çŸ­æœŸï¼ˆ1-2 å‘¨ï¼‰
1. å®Œæˆ Analyzer æœåŠ¡é›†æˆï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰
2. å®Œæˆ Deployer æœåŠ¡é›†æˆ
3. æ‰©å±• WebSocket äº‹ä»¶
4. åˆ›å»ºå·¥å…·æ€»è§ˆé¡µ

### ä¸­æœŸï¼ˆ3-4 å‘¨ï¼‰
5. å®ç°å·¥ä½œæµå¼•æ“
6. é›†æˆå‰©ä½™å·¥å…·æœåŠ¡ï¼ˆTester, Docs-generatorç­‰ï¼‰
7. å®Œå–„ UI ç•Œé¢

### é•¿æœŸï¼ˆ5-8 å‘¨ï¼‰
8. å¼€å‘å¯è§†åŒ–å›¾è¡¨ç»„ä»¶
9. æ€§èƒ½ä¼˜åŒ–
10. ç¼–å†™æ–‡æ¡£å’Œæµ‹è¯•

## ğŸ’¡ æŠ€æœ¯äº®ç‚¹

1. **ç±»å‹å®‰å…¨**: å®Œæ•´çš„ TypeScript ç±»å‹å®šä¹‰
2. **æ¨¡æ‹Ÿæ¨¡å¼**: æ”¯æŒåœ¨æ²¡æœ‰å®é™…å·¥å…·åŒ…æ—¶ä»¥æ¨¡æ‹Ÿæ¨¡å¼è¿è¡Œ
3. **å¥åº·æ£€æŸ¥**: è‡ªåŠ¨æ£€æµ‹æœåŠ¡å¥åº·çŠ¶æ€
4. **è¿›åº¦è¿½è¸ª**: å®æ—¶è¿›åº¦äº‹ä»¶æ¨é€
5. **æ•°æ®æŒä¹…åŒ–**: æ‰€æœ‰æ“ä½œè®°å½•ä¿å­˜åˆ°æ•°æ®åº“
6. **ç”¨æˆ·å‹å¥½**: ç°ä»£åŒ–çš„ UI è®¾è®¡

## ğŸ“Š è¿›åº¦ç»Ÿè®¡

- **æ€»ä»»åŠ¡æ•°**: 21 é¡¹
- **å·²å®Œæˆ**: 5 é¡¹ï¼ˆ24%ï¼‰
- **è¿›è¡Œä¸­**: 0 é¡¹
- **å¾…å®Œæˆ**: 16 é¡¹ï¼ˆ76%ï¼‰

**å®Œæˆçš„æ ¸å¿ƒé‡Œç¨‹ç¢‘**:
âœ… æ•°æ®åº“æ¶æ„è®¾è®¡
âœ… æœåŠ¡ç®¡ç†å™¨æ¡†æ¶
âœ… Builder å®Œæ•´é›†æˆï¼ˆæœåŠ¡+API+UIï¼‰
âœ… ä¾èµ–é…ç½®
âœ… åŸºç¡€ç±»å‹ç³»ç»Ÿ

**ä¸‹ä¸€ä¸ªé‡Œç¨‹ç¢‘**: Analyzer æœåŠ¡é›†æˆ

---

**æ›´æ–°æ—¥æœŸ**: 2025-10-23
**ç‰ˆæœ¬**: v0.1.0-alpha
**çŠ¶æ€**: å¼€å‘ä¸­ ğŸš§


